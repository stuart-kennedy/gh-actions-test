name: windows

on: push

jobs:
  run:
    runs-on: windows-latest
    steps:
      - name: Find vstest
        id: vstest
        shell: bash
        run: |
          $vspath=$(vswhere \
            -latest \
            -products * \
            -requires Microsoft.VisualStudio.Workload.ManagedDesktop Microsoft.VisualStudio.Workload.Web \
            -requiresAny \
            -property installationPath)
          $vstestpath="$vspath\Common7\IDE\CommonExtensions\Microsoft\TestWindow\vstest.console.exe"
          echo "path=$vstestpath" >> $GITHUB_OUTPUT
        
      - run: echo ${{ steps.vstest.outputs.path }}
